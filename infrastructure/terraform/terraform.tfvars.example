# =============================================================================
# BlueprintPipeline - Example Terraform Variables
# =============================================================================
# Copy this file to terraform.tfvars and customize for your project.
#
#   cp terraform.tfvars.example terraform.tfvars
#   # Edit terraform.tfvars with your values
#   terraform init
#   terraform apply
# =============================================================================

# Required: Your GCP project ID
project_id = "your-gcp-project-id"

# Region and zone for resources
region = "us-central1"
zone   = "us-central1-a"

# Multi-region or dual-region bucket location (e.g., US, EU, NAM4)
bucket_location = "US"

# Optional secondary region (for GKE failover)
enable_secondary_region = false
secondary_region        = "us-east1"
secondary_zone          = "us-east1-b"
secondary_cluster_name  = "blueprint-cluster-secondary"

# Environment (dev, staging, prod)
environment = "prod"

# =============================================================================
# GKE Cluster Configuration
# =============================================================================

cluster_name       = "blueprint-cluster"
kubernetes_version = "1.29"
release_channel    = "REGULAR"  # RAPID, REGULAR, or STABLE

# =============================================================================
# Node Pool Configuration
# =============================================================================

# CPU nodes (for non-GPU workloads like simready, usd-assembly)
cpu_node_machine_type = "e2-standard-4"  # 4 vCPU, 16GB RAM
cpu_node_count_min    = 1
cpu_node_count_max    = 10

# GPU nodes (for Isaac Sim workloads)
gpu_node_machine_type = "n1-standard-8"  # 8 vCPU, 30GB RAM
gpu_node_count_min    = 0                # Scale to 0 when idle
gpu_node_count_max    = 10

# GPU type options:
# - nvidia-tesla-t4      (16GB VRAM, good balance of cost/performance)
# - nvidia-l4            (24GB VRAM, next-gen inference GPU)
# - nvidia-tesla-v100    (32GB VRAM, high performance)
# - nvidia-a100-80gb     (80GB VRAM, highest performance)
gpu_type = "nvidia-tesla-t4"

gpus_per_node = 1

# GPU CI nodes (for GitHub Actions runners)
ci_gpu_node_machine_type = "n1-standard-8"
ci_gpu_node_count_min    = 0
ci_gpu_node_count_max    = 2
ci_gpus_per_node         = 1

# =============================================================================
# Networking
# =============================================================================

subnet_cidr   = "10.0.0.0/20"
pods_cidr     = "10.1.0.0/16"
services_cidr = "10.2.0.0/20"
master_cidr   = "172.16.0.0/28"

# Authorized networks for GKE master access
# Add CI/CD runner IPs and developer VPN ranges
master_authorized_networks = [
  {
    cidr_block   = "203.0.113.0/24"
    display_name = "CI/CD runners"
  },
  {
    cidr_block   = "198.51.100.0/24"
    display_name = "Developer VPN"
  },
]

# =============================================================================
# Features
# =============================================================================

enable_private_nodes        = true   # Recommended for production
enable_workload_identity    = true   # Recommended for security
enable_network_policy       = true   # Calico network policies
enable_binary_authorization = false  # Enable for production
enable_shielded_nodes       = true   # Secure boot + integrity monitoring

# =============================================================================
# Labels
# =============================================================================

labels = {
  managed_by  = "terraform"
  project     = "blueprint-pipeline"
  team        = "robotics"
  cost_center = "engineering"
}

# =============================================================================
# Secret rotation automation
# =============================================================================

# Firebase service account JSON (creates firebase-service-account secret when set)
# firebase_service_account_json = "{\"type\":\"service_account\",...}"

# Container image for the Cloud Run rotation job
secret_rotation_job_image = "us-docker.pkg.dev/your-gcp-project-id/pipeline/secret-rotation:latest"

# Comma-delimited list of secret IDs to rotate
secret_rotation_secret_ids = [
  "pipeline-internal-token",
]

# Cron schedule (default: daily at 03:00 UTC)
secret_rotation_schedule  = "0 3 * * *"
secret_rotation_time_zone = "Etc/UTC"

# Random byte length for generated values
secret_rotation_byte_length = 32

# =============================================================================
# Retention cleanup workflow
# =============================================================================

# Optional override for the retention cleanup payload bucket
# retention_cleanup_bucket = "your-project-blueprint-data"

# Cron schedule (default: daily at 03:00 UTC)
retention_cleanup_schedule  = "0 3 * * *"
retention_cleanup_time_zone = "Etc/UTC"

# =============================================================================
# Firebase Storage lifecycle (optional)
# =============================================================================

# Firebase Storage bucket name (e.g., <project-id>.appspot.com)
# firebase_storage_bucket = "your-project-id.appspot.com"

# Bucket location must match existing Firebase bucket
firebase_storage_bucket_location = "US"
