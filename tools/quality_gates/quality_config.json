{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "Quality Gate Configuration",
  "description": "Configurable thresholds and settings for quality gates. Labs can customize these values for their specific use cases.",
  "version": "1.2.0",
  "thresholds": {
    "physics": {
      "mass_min_kg": 0.01,
      "mass_max_kg": 500.0,
      "friction_min": 0.0,
      "friction_max": 2.0,
      "inertia_min": 0.0,
      "description": "Physics property validation thresholds"
    },
    "episodes": {
      "collision_free_rate_min": "DEFAULT_COLLISION_FREE_RATE_MIN",
      "quality_score_min": "DEFAULT_QUALITY_SCORE_MIN",
      "quality_pass_rate_min": 0.75,
      "min_episodes_required": 5,
      "tier_thresholds": {
        "core": {
          "collision_free_rate_min": "DEFAULT_COLLISION_FREE_RATE_MIN",
          "quality_score_min": "DEFAULT_QUALITY_SCORE_MIN",
          "quality_pass_rate_min": 0.75,
          "min_episodes_required": 3
        },
        "plus": {
          "collision_free_rate_min": "DEFAULT_COLLISION_FREE_RATE_MIN",
          "quality_score_min": "DEFAULT_QUALITY_SCORE_MIN",
          "quality_pass_rate_min": 0.75,
          "min_episodes_required": 5
        },
        "full": {
          "collision_free_rate_min": "DEFAULT_COLLISION_FREE_RATE_MIN",
          "quality_score_min": "DEFAULT_QUALITY_SCORE_MIN",
          "quality_pass_rate_min": 0.75,
          "min_episodes_required": 5
        }
      },
      "description": "Episode generation quality thresholds"
    },
    "data_quality": {
      "min_average_quality_score": "DEFAULT_AVERAGE_QUALITY_SCORE_MIN",
      "min_sensor_capture_rate": "DEFAULT_SENSOR_CAPTURE_RATE_MIN",
      "min_physics_validation_rate": "DEFAULT_PHYSICS_VALIDATION_RATE_MIN",
      "allowed_sensor_sources": [
        "isaac_sim_replicator",
        "simulation"
      ],
      "allowed_physics_backends": [
        "isaac_sim",
        "isaac_lab"
      ],
      "description": "SLI thresholds for sensor capture + physics validation"
    },
    "simulation": {
      "min_stable_steps": 20,
      "max_penetration_depth_m": 0.005,
      "physics_stability_timeout_s": 30.0,
      "description": "Simulation stability thresholds"
    },
    "usd": {
      "max_usd_size_bytes": 500000000,
      "max_broken_references": 0,
      "require_physics_scene": true,
      "require_header_validation": true,
      "description": "USD scene validation thresholds"
    },
    "replicator": {
      "required_sensor_fields": {
        "camera_list": ["cameras", "camera_list"],
        "resolution": ["resolution"],
        "modalities": ["modalities", "annotations"],
        "stream_ids": ["stream_ids", "streams"]
      },
      "description": "Replicator bundle sensor metadata requirements"
    },
    "episode_metadata": {
      "required_fields": {
        "dataset_name": {
          "paths": ["dataset_name", "name"],
          "type": "string"
        },
        "scene_id": {
          "paths": ["scene_id", "scene.scene_id"],
          "type": "string"
        },
        "robot_type": {
          "paths": ["robot_type", "robot.type"],
          "type": "string"
        },
        "camera_specs": {
          "paths": ["camera_specs", "data_pack.cameras", "cameras"],
          "type": "array_or_object"
        },
        "fps": {
          "paths": ["fps"],
          "type": "number"
        },
        "action_space": {
          "paths": ["action_space", "action_space_info"],
          "type": "array_or_object"
        },
        "episode_stats": {
          "paths": ["episode_stats", "stats"],
          "type": "object"
        }
      },
      "description": "Episode metadata schema requirements"
    },
    "dwm": {
      "required_files": [
        "manifest.json",
        "static_scene_video.mp4",
        "camera_trajectory.json",
        "metadata/scene_info.json",
        "metadata/prompt.txt"
      ],
      "description": "DWM conditioning bundle structure requirements"
    },
    "inventory_enrichment": {
      "min_object_count": "DEFAULT_INVENTORY_MIN_OBJECTS",
      "require_enrichment_metadata": true,
      "allowed_statuses": ["success", "stub"],
      "description": "Inventory enrichment output requirements"
    },
    "variation_assets": {
      "min_object_count": "DEFAULT_VARIATION_MIN_OBJECTS",
      "min_3d_success_rate": "DEFAULT_VARIATION_3D_SUCCESS_RATE_MIN",
      "description": "Variation asset generation requirements"
    },
    "scale": {
      "min_scale_factor": "DEFAULT_SCALE_FACTOR_MIN",
      "max_scale_factor": "DEFAULT_SCALE_FACTOR_MAX",
      "min_confidence": "DEFAULT_SCALE_CONFIDENCE_MIN",
      "description": "Scale calibration validation thresholds"
    },
    "interactive": {
      "min_ok_rate": "DEFAULT_INTERACTIVE_OK_RATE_MIN",
      "min_physics_stability_rate": "DEFAULT_INTERACTIVE_STABILITY_RATE_MIN",
      "max_fallback_rate": "DEFAULT_INTERACTIVE_FALLBACK_RATE_MAX",
      "description": "Interactive asset processing thresholds"
    },
    "isaac_lab": {
      "require_env_cfg": true,
      "require_task_files": true,
      "syntax_check_enabled": true,
      "description": "Isaac Lab code generation thresholds"
    },
    "geniesim_kinematic_reachability": {
      "enabled": true,
      "min_reachability_rate": 1.0,
      "max_unreachable_targets": 0,
      "check_place_targets": true,
      "description": "Reachability requirements for Genie Sim task target poses (no unreachable targets allowed)"
    },
    "geniesim_data_collection": {
      "min_collision_free_rate": 0.9,
      "min_task_success_rate": 0.8,
      "description": "Genie Sim data collection quality thresholds"
    }
  },
  "human_approval": {
    "enabled": true,
    "timeout_hours": 24,
    "auto_approve_on_timeout": false,
    "allow_auto_approve_on_timeout_non_production": false,
    "approval_methods": ["dashboard", "email", "api"],
    "default_approvers": [],
    "escalation_after_hours": 12,
    "escalation_contacts": [],
    "notification_channels": [],
    "description": "Human-in-the-loop approval workflow settings (auto-approve on timeout requires explicit non-production allowance; production always expires)"
  },
  "approval_store": {
    "backend": "firestore",
    "filesystem_path": "/var/lib/blueprintpipeline/approvals",
    "firestore_collection": "quality_gate_approvals",
    "migrate_from_filesystem": false,
    "description": "Storage backend configuration for approval requests"
  },
  "notifications": {
    "email_recipients": [],
    "sms_recipients": [],
    "slack_webhook_url": null,
    "notify_on_pass": false,
    "notify_on_warning": true,
    "notify_on_error": true,
    "notify_on_approval_required": true
  },
  "gate_overrides": {
    "allow_manual_override": true,
    "allow_override_in_production": false,
    "override_requires_reason": true,
    "override_log_retention_days": 90,
    "allowed_overriders": [],
    "override_reason_schema": {
      "required_fields": ["category", "ticket", "justification"],
      "categories": ["data_gap", "tooling_failure", "known_issue", "customer_exception", "other"],
      "ticket_pattern": "^(https?://|[A-Za-z][A-Za-z0-9._-]*-\\d+)$",
      "justification_min_length": 50,
      "description": "Structured override reason schema (category + ticket + justification)"
    },
    "description": "Settings for manual gate override functionality"
  },
  "severity_handling": {
    "error": {
      "blocks_pipeline": true,
      "requires_human_approval": true,
      "auto_retry_count": 0
    },
    "warning": {
      "blocks_pipeline": false,
      "requires_human_approval": false,
      "auto_retry_count": 1
    },
    "info": {
      "blocks_pipeline": false,
      "requires_human_approval": false,
      "auto_retry_count": 0
    }
  }
}
