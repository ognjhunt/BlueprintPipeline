# =============================================================================
# Text-First Source Pipeline Configuration
# =============================================================================
#
# Environment variables for the source-orchestrator and text Stage 1 jobs.
# Source these in your shell or set them in Cloud Run / Workflow env config.
#
# Usage:
#   source configs/text_source.env
#
# =============================================================================

# --- Source Orchestrator ---

# Default source mode when scene_request.json omits source_mode.
# Options: text, image, auto
DEFAULT_SOURCE_MODE=text

# Runtime hint for text Stage 1 execution.
# Options: vm (run on existing GPU VM), cloudrun (Cloud Run jobs)
TEXT_GEN_RUNTIME=vm

# Maximum allowed seed_count per scene_request.json.
# Prevents runaway cost from excessively large fan-out requests.
TEXT_GEN_MAX_SEEDS=16

# Allow auto/text mode to fall back to image pipeline when text generation fails
# and an image payload is present in the request.
TEXT_GEN_ENABLE_IMAGE_FALLBACK=true

# Image compatibility mode used by source-orchestrator.
# orchestrator: delegates to image-to-scene-orchestrator (synchronous end-to-end)
# legacy_chain: delegates to image-to-scene-pipeline and waits for .geniesim_complete
IMAGE_PATH_MODE=orchestrator

# Workflow names for image compatibility mode dispatch.
IMAGE_ORCHESTRATOR_WORKFLOW_NAME=image-to-scene-orchestrator
IMAGE_LEGACY_WORKFLOW_NAME=image-to-scene-pipeline

# Legacy-chain mode wait timeout while polling for scenes/<scene_id>/geniesim/.geniesim_complete
IMAGE_LEGACY_CHAIN_WAIT_SECONDS=7200

# --- Text Scene Gen Job ---

# Profile labels injected into text-scene-gen-job for tier selection.
# These are metadata labels; the actual tier behavior is controlled by QualityTier enum.
TEXT_GEN_STANDARD_PROFILE=standard_v1
TEXT_GEN_PREMIUM_PROFILE=premium_v1

# Override the quality tier regardless of request payload.
# Leave empty to respect the request's quality_tier field.
# Options: standard, premium
# TEXT_GEN_QUALITY_TIER=

# Enable LLM-based scene planning (requires API keys for provider chain).
# When false (default), uses deterministic room templates.
# Options: true, false
TEXT_GEN_USE_LLM=false

# --- VM Text Runtime ---
#
# Used only when TEXT_GEN_RUNTIME=vm.
# The source-orchestrator launches Cloud Build + SSH and runs both text jobs on this VM.
TEXT_GEN_VM_NAME=isaac-sim-ubuntu
TEXT_GEN_VM_ZONE=us-east1-c
TEXT_GEN_VM_REPO_DIR=~/BlueprintPipeline
TEXT_GEN_VM_TIMEOUT_SECONDS=2400

# --- VLM Quality Audit (Genie Sim Export) ---

# Enable VLM episode quality audit during Genie Sim export/import.
# Set to 1 to enable, 0 to disable.
# Default in genie-sim-export-pipeline.yaml: 1
ENABLE_VLM_QUALITY_AUDIT=1
